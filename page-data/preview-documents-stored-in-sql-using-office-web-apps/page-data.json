{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/preview-documents-stored-in-sql-using-office-web-apps","result":{"data":{"wpCategory":{"posts":{"nodes":[{"id":"cG9zdDo3OTQ=","title":"SOLID Principles","excerpt":"<p>&nbsp; From my point of view, the consolidation and internalization of concepts that promote a significant improvement in the quality of software is a &#8220;must&#8221; for any programmer, so I always take that into account when I am developing software. Having that in mind, in this post I will write about&nbsp;SOLID principles. SOLID is an&hellip; <a class=\"more-link\" href=\"/solid-principles/\">Continue reading <span class=\"screen-reader-text\">SOLID Principles</span></a></p>\n","slug":"solid-principles","featuredImage":{"node":{"altText":"","localFile":{"childImageSharp":{"fluid":{"tracedSVG":"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='360'%20height='240'%20viewBox='0%200%20360%20240'%20preserveAspectRatio='none'%3e%3cpath%20d='M0%2051c0%2051%200%2052%202%2053%204%202%203%2014-1%2014l-1%2025c0%2024%200%2024%202%2020l2-5c2-1%201%202-1%208l-3%205v69h96V0H0v51m113%2069v120h160V0H113v120m179%200v120h68v-8c0-6%200-7-1-4s-1%201-1-5%200-9%201-8l1-27c0-19%200-28-1-27l-1%205c0%203%200%204-1%203a607%20607%200%20003-113V0h-68v120M129%2041l1%2028h5V13h-6v28m187-27h-8v28l1%2028%2010-1c12%200%2017-1%2023-5%206-5%209-12%2010-21%201-22-10-30-36-29m-2%2027v24h8l12-2c16-7%2017-35%202-42l-13-3h-9v23m-176%2062c-5%204-4%209%204%2014%206%204%208%207%204%2010h-7c-4-1-5-1-4%201%201%203%2011%203%2014%200%204-5%202-9-6-14-8-4-6-11%202-10%204%201%205%200%205-1-1-3-9-3-12%200m18-1c-1%204%201%2028%202%2028s2-2%202-5v-5l4-1c7-1%2011-8%208-14-2-3-14-6-16-3m149%2014v14h6c13%200%2019-9%2015-20-2-5-6-7-14-8h-7v14m37%200l1%2014c1%200%202-1%202-5l1-5%204-1c3%200%204-1%206-3%206-7%202-13-8-14h-6v14m-182-11v5c0%205%200%206%203%206%206%200%2010-7%205-10-2-2-8-3-8-1m148%2012v11h4c9%200%2015-9%2010-18-1-4-4-5-10-5h-4v12m37-6v6h4c6%200%209-7%205-10l-5-2h-4v6m-42%2050c1%209%201%2010%207%209%2010-3%208-17-3-17h-4v8m2%201c0%206%200%206%203%206%204%200%206-3%206-7s-2-6-6-6c-3%200-3%200-3%207m26%205l1%208%201-3c0-2%200-3%203-2%203%200%205-2%205-7%200-4-1-5-6-5h-4v9m-182%2020c-4%205-1%2011%204%2010l3%201c0%202-3%203-5%203h-3c0%202%205%202%208%201%202-2%202-3%202-9v-7l-4-1c-3%200-4%200-5%202m34-1c-2%201-3%208-1%2010l5%201c3-1%204%200%202%202-1%202-2%202-4%202-3-1-4%201-1%202%205%201%209-6%208-15%200-2-1-2-4-3l-5%201m38%201c-2%201-3%207-1%209l5%201c4%200%205-2%205-6%200-6-6-8-9-4m-181%202c-2%203-1%207%202%208%203%202%207%200%208-3%202-7-6-11-10-5m85%2020v16l1-3c0-2%200-3%202-3%203%200%206-3%206-6s-7-7-9-4m178%208l1%208%201-3c0-3%200-3%203-3%207-1%206-10-2-10h-3v8m-124%205l1%208%201-2c0-2%201-3%203-3%205-1%207-5%205-9-1-2-2-3-6-3h-4v9M2%20223l1%208%201-3c0-2%200-3%202-2%204%200%206-2%206-7%200-4-1-5-6-5H2v9'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e","aspectRatio":3.6231884057971016,"src":"/static/0ce14669086579513c07beedc4b84cf0/724c8/Solid-1024x283-1.jpg","srcSet":"/static/0ce14669086579513c07beedc4b84cf0/84d81/Solid-1024x283-1.jpg 250w,\n/static/0ce14669086579513c07beedc4b84cf0/f0719/Solid-1024x283-1.jpg 500w,\n/static/0ce14669086579513c07beedc4b84cf0/724c8/Solid-1024x283-1.jpg 1000w,\n/static/0ce14669086579513c07beedc4b84cf0/26852/Solid-1024x283-1.jpg 1024w","sizes":"(max-width: 1000px) 100vw, 1000px"}}}}},"categories":{"nodes":[{"name":".NET","slug":"net"},{"name":"DevScope","slug":"dvs"}]}},{"id":"cG9zdDoyODg=","title":"Preview Documents Stored in SQL using Office Web Apps","excerpt":"<p>In one of our projects we had an interesting challenge, how could we preview documents stored on an SQL Database using Office Web Apps (like we see in SharePoint). To accomplish that we created a Wopi Host and in this blog post we will briefly explain how a Wopi Host works and how it allowed&hellip; <a class=\"more-link\" href=\"/preview-documents-stored-in-sql-using-office-web-apps/\">Continue reading <span class=\"screen-reader-text\">Preview Documents Stored in SQL using Office Web Apps</span></a></p>\n","slug":"preview-documents-stored-in-sql-using-office-web-apps","featuredImage":{"node":{"altText":"Office WebApps","localFile":{"childImageSharp":{"fluid":{"tracedSVG":"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='360'%20height='240'%20viewBox='0%200%20360%20240'%20preserveAspectRatio='none'%3e%3cpath%20d='M0%20120v120h361V0H0v120m150-67c-8%203-16%209-21%2017l-3%204-5-2c-19-7-38%207-40%2029v7l-5%201c-23%209-23%2044%201%2052l4%202v-10l1-9%206-1h7v-5c2-12%2011-21%2024-25l3-5c8-29%2040-40%2060-20%205%205%206%205%208%204l6-1c4%200%204-1%203-7-4-13-13-24-24-29-7-3-19-4-25-2m153%2018l-5%204c-1%202-2%202-5%201-5%200-10%203-11%209l-2%204c-8%204-5%2017%204%2017%203%200%203%200%203-4-1-5%201-10%205-11l4-5c2-6%2012-9%2017-5%204%203%207%203%206%200-2-8-10-13-16-10m-2%2012l-4%205-4%204c-5%203-6%2012-1%2015%203%202%2039%201%2040-1%202-2%202-8-1-10l-3-4c0-4-5-7-9-7l-6-2c-3-2-9-3-12%200m-150%202c-12%203-22%2015-25%2028%200%203-1%204-3%205-13%203-20%209-22%2020v5h21l21%201v27h13v-54h35l34-1c0-2-6-10-9-13-7-6-18-8-26-5-4%202-4%202-7-1-9-11-21-15-32-12m49%2051c-5%202-6%203-5%2012v8l5%201%206%202%202-1c0-2%201-2%205-2h4v-18h-4l-5-1c0-2-2-2-8-1m-92%2020l-4%201v6c0%206%200%207%202%207h7l4-1h3v-5c0-5-1-6-6-5l-1-2-5-1m174%202c-3%201-4%202-4%207%200%206%200%207%207%208l3%201v-7c0-5%200-7%201-6v7c0%204%200%204%203%204%202%200%202-1%202-3v-6c0-4%200-4-3-4l-3-1h-6'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e","aspectRatio":1.7482517482517483,"src":"/static/09f88b011454fd3b9dfa1bf885b65f2f/1ac3a/C2oG3BUWEAIFRch-1.jpg","srcSet":"/static/09f88b011454fd3b9dfa1bf885b65f2f/84d81/C2oG3BUWEAIFRch-1.jpg 250w,\n/static/09f88b011454fd3b9dfa1bf885b65f2f/f0719/C2oG3BUWEAIFRch-1.jpg 500w,\n/static/09f88b011454fd3b9dfa1bf885b65f2f/1ac3a/C2oG3BUWEAIFRch-1.jpg 690w","sizes":"(max-width: 690px) 100vw, 690px"}}}}},"categories":{"nodes":[{"name":".NET","slug":"net"},{"name":"DevScope","slug":"dvs"},{"name":"SharePoint","slug":"sp"}]}}]}},"wpPost":{"title":"Preview Documents Stored in SQL using Office Web Apps","content":"<p><span class=\"aligncenter size-full wp-image-314 inline-gatsby-image-wrapper gatsby-image-wrapper\" style=\"position:relative;overflow:hidden;max-width:100%;width:690px\" data-reactroot=\"\"><span aria-hidden=\"true\" style=\"width:100%;padding-bottom:57.225433526011564%\"></span><img aria-hidden=\"true\" src=\"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAMC/8QAFwEAAwEAAAAAAAAAAAAAAAAAAgMEBf/aAAwDAQACEAMQAAAB1OSTQAGf/8QAGBABAQADAAAAAAAAAAAAAAAAAQIAAyD/2gAIAQEAAQUC1RLiSVx//8QAFxEAAwEAAAAAAAAAAAAAAAAAAhARMf/aAAgBAwEBPwGFdX//xAAWEQADAAAAAAAAAAAAAAAAAAABEBH/2gAIAQIBAT8BoX//xAAbEAAABwEAAAAAAAAAAAAAAAAAAQIREiBBgf/aAAgBAQAGPwJ1HwbGv//EABoQAQACAwEAAAAAAAAAAAAAAAEQEQAhUTH/2gAIAQEAAT8hD0+dZ7WwsQmiP//aAAwDAQACAAMAAAAQxC//xAAXEQADAQAAAAAAAAAAAAAAAAABECEx/9oACAEDAQE/ELDhf//EABcRAQADAAAAAAAAAAAAAAAAAAEQESH/2gAIAQIBAT8QxCo//8QAGxABAQACAwEAAAAAAAAAAAAAAREAECExYaH/2gAIAQEAAT8QdHIwGMd35i0T5CHy6g8zPA1//9k=\" alt=\"\" style=\"position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:0;transition-delay:500ms\"/><picture><source srcSet=\"/static/09f88b011454fd3b9dfa1bf885b65f2f/5a8b5/C2oG3BUWEAIFRch-1.jpg 173w,\n/static/09f88b011454fd3b9dfa1bf885b65f2f/19e5e/C2oG3BUWEAIFRch-1.jpg 345w,\n/static/09f88b011454fd3b9dfa1bf885b65f2f/797d9/C2oG3BUWEAIFRch-1.jpg 690w\" sizes=\"(max-width: 690px) 100vw, 690px\"/><img sizes=\"(max-width: 690px) 100vw, 690px\" srcSet=\"/static/09f88b011454fd3b9dfa1bf885b65f2f/5a8b5/C2oG3BUWEAIFRch-1.jpg 173w,\n/static/09f88b011454fd3b9dfa1bf885b65f2f/19e5e/C2oG3BUWEAIFRch-1.jpg 345w,\n/static/09f88b011454fd3b9dfa1bf885b65f2f/797d9/C2oG3BUWEAIFRch-1.jpg 690w\" src=\"/static/09f88b011454fd3b9dfa1bf885b65f2f/797d9/C2oG3BUWEAIFRch-1.jpg\" alt=\"Office WebApps\" loading=\"eager\" style=\"position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition:opacity 500ms\"/></picture><noscript><picture><source srcset=\"/static/09f88b011454fd3b9dfa1bf885b65f2f/5a8b5/C2oG3BUWEAIFRch-1.jpg 173w,\n/static/09f88b011454fd3b9dfa1bf885b65f2f/19e5e/C2oG3BUWEAIFRch-1.jpg 345w,\n/static/09f88b011454fd3b9dfa1bf885b65f2f/797d9/C2oG3BUWEAIFRch-1.jpg 690w\" sizes=\"(max-width: 690px) 100vw, 690px\" /><img loading=\"eager\" sizes=\"(max-width: 690px) 100vw, 690px\" srcset=\"/static/09f88b011454fd3b9dfa1bf885b65f2f/5a8b5/C2oG3BUWEAIFRch-1.jpg 173w,\n/static/09f88b011454fd3b9dfa1bf885b65f2f/19e5e/C2oG3BUWEAIFRch-1.jpg 345w,\n/static/09f88b011454fd3b9dfa1bf885b65f2f/797d9/C2oG3BUWEAIFRch-1.jpg 690w\" src=\"/static/09f88b011454fd3b9dfa1bf885b65f2f/797d9/C2oG3BUWEAIFRch-1.jpg\" alt=\"Office WebApps\" style=\"position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center\"/></picture></noscript></span>In one of our projects we had an interesting challenge, how could we preview documents stored on an SQL Database using Office Web Apps (like we see in SharePoint). To accomplish that we created a Wopi Host and in this blog post we will briefly explain how a Wopi Host works and how it allowed us to preview documents using OWA.</p>\n<p>So, how can we request a preview?</p>\n<p>First we  must know what app to use to open the document and if it is available on our current installation of Office Web Apps. That is done through the Discovery.xml, there we can find information about the apps available and to what url we must do the request. You can find this file under <a href=\"http://owa1.wingtip.com/hosting/discovery\">/hosting/discovery</a> on your Office Web Apps. With that we have the first part of our preview url (example for a word document):</p>\n<p style=\"text-align: center\"><em>http://owa/wv/wordviewerframe.aspx</em></p>\n<p>After that we must tell Office Web Apps how to get the document. This is where the Wopi Host comes into play. Here we will have the wopi host url and the file name/id and it will be sent as a query string parameter to office web apps:</p>\n<p style=\"text-align: center\"><em>?WOPISrc=https://wopihost/api/wopi/files/{filename}?access_token={access token}&amp;access_token_ttl={time to live}</em></p>\n<ul>\n<li style=\"text-align: left\">File Name: string representing the file to be opened. It must represent a single file and be URL-safe;</li>\n<li style=\"text-align: left\">Access Token: a string that can be used to determine the identity and permissions of the issuer of the request;</li>\n<li style=\"text-align: left\">Access Token Time to Live: tell the WOPI client when the access token expires. It is represented as the number of milisecondes since January 1, 1970 UTC;</li>\n</ul>\n<p style=\"text-align: left\">With the complete URL all we have to do is get it into an iframe, after that all the calls/exchange of information will be handle by Office Web Apps and our Wopi Host. We need to implement the following methods in our wopi api:</p>\n<h4 style=\"text-align: left\">GetFileInfo</h4>\n<p><span class=\"size-full wp-image-300 aligncenter inline-gatsby-image-wrapper gatsby-image-wrapper\" style=\"position:relative;overflow:hidden;max-width:100%;width:476px\" data-reactroot=\"\"><span aria-hidden=\"true\" style=\"width:100%;padding-bottom:9.243697478991596%\"></span><img aria-hidden=\"true\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAXklEQVQI103GWwqAIBAAwO5/xUJd3XxgqRkpRrURQTRf07m1phCLMcX7TeviXA5zbTsRXQ/6/P/q+uGccsOQxrAoH13MIEFKEFwgWmMOAAIYFWJKxDkhLkqBtZYxdgM6nHChpYp2zgAAAABJRU5ErkJggg==\" alt=\"\" style=\"position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:0;transition-delay:500ms\"/><picture><source srcSet=\"/static/78f6c4336989a6a63c1070b3511b53f4/36718/getfileinfo-1.png 119w,\n/static/78f6c4336989a6a63c1070b3511b53f4/3f239/getfileinfo-1.png 238w,\n/static/78f6c4336989a6a63c1070b3511b53f4/d9059/getfileinfo-1.png 476w\" sizes=\"(max-width: 476px) 100vw, 476px\"/><img sizes=\"(max-width: 476px) 100vw, 476px\" srcSet=\"/static/78f6c4336989a6a63c1070b3511b53f4/36718/getfileinfo-1.png 119w,\n/static/78f6c4336989a6a63c1070b3511b53f4/3f239/getfileinfo-1.png 238w,\n/static/78f6c4336989a6a63c1070b3511b53f4/d9059/getfileinfo-1.png 476w\" src=\"/static/78f6c4336989a6a63c1070b3511b53f4/d9059/getfileinfo-1.png\" alt=\"\" loading=\"eager\" style=\"position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition:opacity 500ms\"/></picture><noscript><picture><source srcset=\"/static/78f6c4336989a6a63c1070b3511b53f4/36718/getfileinfo-1.png 119w,\n/static/78f6c4336989a6a63c1070b3511b53f4/3f239/getfileinfo-1.png 238w,\n/static/78f6c4336989a6a63c1070b3511b53f4/d9059/getfileinfo-1.png 476w\" sizes=\"(max-width: 476px) 100vw, 476px\" /><img loading=\"eager\" sizes=\"(max-width: 476px) 100vw, 476px\" srcset=\"/static/78f6c4336989a6a63c1070b3511b53f4/36718/getfileinfo-1.png 119w,\n/static/78f6c4336989a6a63c1070b3511b53f4/3f239/getfileinfo-1.png 238w,\n/static/78f6c4336989a6a63c1070b3511b53f4/d9059/getfileinfo-1.png 476w\" src=\"/static/78f6c4336989a6a63c1070b3511b53f4/d9059/getfileinfo-1.png\" alt=\"\" style=\"position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center\"/></picture></noscript></span></p>\n<p>Here the Office Web Apps will be expecting to receive information about the file:</p>\n<ul>\n<li>BaseFileName [string]: name of the file including extension, without a path</li>\n<li>OwnerId [string]: unique identifier of the owner of the file</li>\n<li>Size [long]: size of the file in bytes</li>\n<li>UserId [string]: unique identifier of the user accessing the file</li>\n<li>Version [string]: file version</li>\n</ul>\n<h4>Get</h4>\n<p><span class=\"aligncenter size-full wp-image-302 inline-gatsby-image-wrapper gatsby-image-wrapper\" style=\"position:relative;overflow:hidden;max-width:100%;width:476px\" data-reactroot=\"\"><span aria-hidden=\"true\" style=\"width:100%;padding-bottom:7.563025210084034%\"></span><img aria-hidden=\"true\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAY0lEQVQI103HSQ6AIAxAUe9/RIeiBVtAhEgcYoxUV8a/+q/KiKsxO9us1DrSbt2GuBF5ouO85Nd9SymfyotKp9y6iPOCU+xDekeFRQ8AQJYEQEYzddDEdDonTS1MXiMy89DDA9uVb67ICleKAAAAAElFTkSuQmCC\" alt=\"\" style=\"position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:0;transition-delay:500ms\"/><picture><source srcSet=\"/static/d0a3fc23db439b6907d2d00cc26d08ae/36718/getfilecontents.png 119w,\n/static/d0a3fc23db439b6907d2d00cc26d08ae/3f239/getfilecontents.png 238w,\n/static/d0a3fc23db439b6907d2d00cc26d08ae/d9059/getfilecontents.png 476w\" sizes=\"(max-width: 476px) 100vw, 476px\"/><img sizes=\"(max-width: 476px) 100vw, 476px\" srcSet=\"/static/d0a3fc23db439b6907d2d00cc26d08ae/36718/getfilecontents.png 119w,\n/static/d0a3fc23db439b6907d2d00cc26d08ae/3f239/getfilecontents.png 238w,\n/static/d0a3fc23db439b6907d2d00cc26d08ae/d9059/getfilecontents.png 476w\" src=\"/static/d0a3fc23db439b6907d2d00cc26d08ae/d9059/getfilecontents.png\" alt=\"\" loading=\"eager\" style=\"position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition:opacity 500ms\"/></picture><noscript><picture><source srcset=\"/static/d0a3fc23db439b6907d2d00cc26d08ae/36718/getfilecontents.png 119w,\n/static/d0a3fc23db439b6907d2d00cc26d08ae/3f239/getfilecontents.png 238w,\n/static/d0a3fc23db439b6907d2d00cc26d08ae/d9059/getfilecontents.png 476w\" sizes=\"(max-width: 476px) 100vw, 476px\" /><img loading=\"eager\" sizes=\"(max-width: 476px) 100vw, 476px\" srcset=\"/static/d0a3fc23db439b6907d2d00cc26d08ae/36718/getfilecontents.png 119w,\n/static/d0a3fc23db439b6907d2d00cc26d08ae/3f239/getfilecontents.png 238w,\n/static/d0a3fc23db439b6907d2d00cc26d08ae/d9059/getfilecontents.png 476w\" src=\"/static/d0a3fc23db439b6907d2d00cc26d08ae/d9059/getfilecontents.png\" alt=\"\" style=\"position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center\"/></picture></noscript></span></p>\n<p>Here we will return the binary content of the file to Office Web Apps.</p>\n<h2>Summarizing</h2>\n<p>In order to use Office Web Apps to preview our documents stored into SQL we first must tell it how to obtain them. To do that we must build the URL as explained above.</p>\n<p>With the URL ready, we place it into an iframe which will start the chain of requests between the Office Web Apps and our Wopi Host in order to get the file info and binary content.</p>\n<p>You can get a complete overview of the WOPI REST API Reference <a href=\"https://wopirest.readthedocs.io/en/latest/index.html\" target=\"_blank\" rel=\"noopener\">here</a> and you can find an working example of a wopi host <a href=\"https://code.msdn.microsoft.com/office/Building-an-Office-Web-f98650d6\" target=\"_blank\" rel=\"noopener\">here</a> .</p>\n","excerpt":"<p>In one of our projects we had an interesting challenge, how could we preview documents stored on an SQL Database using Office Web Apps (like we see in SharePoint). To accomplish that we created a Wopi Host and in this blog post we will briefly explain how a Wopi Host works and how it allowed&hellip; <a class=\"more-link\" href=\"/preview-documents-stored-in-sql-using-office-web-apps/\">Continue reading <span class=\"screen-reader-text\">Preview Documents Stored in SQL using Office Web Apps</span></a></p>\n","date":"April 07, 2017","modified":"April 07, 2017","author":{"node":{"id":"dXNlcjox","name":"admin","url":null,"description":null,"slug":"admin"}},"slug":"preview-documents-stored-in-sql-using-office-web-apps","id":"cG9zdDoyODg=","featuredImage":{"node":{"altText":"Office WebApps","localFile":{"childImageSharp":{"fluid":{"tracedSVG":"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='360'%20height='240'%20viewBox='0%200%20360%20240'%20preserveAspectRatio='none'%3e%3cpath%20d='M0%20120v120h361V0H0v120m150-67c-8%203-16%209-21%2017l-3%204-5-2c-19-7-38%207-40%2029v7l-5%201c-23%209-23%2044%201%2052l4%202v-10l1-9%206-1h7v-5c2-12%2011-21%2024-25l3-5c8-29%2040-40%2060-20%205%205%206%205%208%204l6-1c4%200%204-1%203-7-4-13-13-24-24-29-7-3-19-4-25-2m153%2018l-5%204c-1%202-2%202-5%201-5%200-10%203-11%209l-2%204c-8%204-5%2017%204%2017%203%200%203%200%203-4-1-5%201-10%205-11l4-5c2-6%2012-9%2017-5%204%203%207%203%206%200-2-8-10-13-16-10m-2%2012l-4%205-4%204c-5%203-6%2012-1%2015%203%202%2039%201%2040-1%202-2%202-8-1-10l-3-4c0-4-5-7-9-7l-6-2c-3-2-9-3-12%200m-150%202c-12%203-22%2015-25%2028%200%203-1%204-3%205-13%203-20%209-22%2020v5h21l21%201v27h13v-54h35l34-1c0-2-6-10-9-13-7-6-18-8-26-5-4%202-4%202-7-1-9-11-21-15-32-12m49%2051c-5%202-6%203-5%2012v8l5%201%206%202%202-1c0-2%201-2%205-2h4v-18h-4l-5-1c0-2-2-2-8-1m-92%2020l-4%201v6c0%206%200%207%202%207h7l4-1h3v-5c0-5-1-6-6-5l-1-2-5-1m174%202c-3%201-4%202-4%207%200%206%200%207%207%208l3%201v-7c0-5%200-7%201-6v7c0%204%200%204%203%204%202%200%202-1%202-3v-6c0-4%200-4-3-4l-3-1h-6'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e","aspectRatio":1.7482517482517483,"src":"/static/09f88b011454fd3b9dfa1bf885b65f2f/1ac3a/C2oG3BUWEAIFRch-1.jpg","srcSet":"/static/09f88b011454fd3b9dfa1bf885b65f2f/84d81/C2oG3BUWEAIFRch-1.jpg 250w,\n/static/09f88b011454fd3b9dfa1bf885b65f2f/f0719/C2oG3BUWEAIFRch-1.jpg 500w,\n/static/09f88b011454fd3b9dfa1bf885b65f2f/1ac3a/C2oG3BUWEAIFRch-1.jpg 690w","sizes":"(max-width: 690px) 100vw, 690px"}}}}},"categories":{"nodes":[{"id":"dGVybToy","link":"/category/net/","count":2,"description":null,"name":".NET","slug":"net"},{"id":"dGVybTo3","link":"/category/dvs/","count":27,"description":null,"name":"DevScope","slug":"dvs"},{"id":"dGVybToxNQ==","link":"/category/sp/","count":29,"description":null,"name":"SharePoint","slug":"sp"}]},"tags":{"nodes":[{"id":"dGVybToxMDI=","link":"/tag/office-web-apps/","count":2,"description":null,"name":"Office Web Apps","slug":"office-web-apps"},{"id":"dGVybToxMDk=","link":"/tag/owa/","count":1,"description":null,"name":"OWA","slug":"owa"},{"id":"dGVybToxMTk=","link":"/tag/preview/","count":1,"description":null,"name":"preview","slug":"preview"},{"id":"dGVybToxMzQ=","link":"/tag/sp/","count":26,"description":null,"name":"sharepoint","slug":"sp"},{"id":"dGVybToxNDk=","link":"/tag/sql/","count":1,"description":null,"name":"Sql","slug":"sql"},{"id":"dGVybToxNTA=","link":"/tag/sql-server/","count":2,"description":null,"name":"Sql Server","slug":"sql-server"},{"id":"dGVybToxNzU=","link":"/tag/wopi/","count":1,"description":null,"name":"Wopi","slug":"wopi"},{"id":"dGVybToxNzY=","link":"/tag/wopi-host/","count":1,"description":null,"name":"Wopi Host","slug":"wopi-host"}]}}},"pageContext":{"id":"cG9zdDoyODg=","slug":"preview-documents-stored-in-sql-using-office-web-apps","firstCategoryId":"dGVybToy","previous":{"id":"cG9zdDo1MDI=","slug":"javascript-api-creating-ribbon-tabs-buttons","status":"publish","title":"Javascript API for creating Ribbon Tabs and Buttons","excerpt":"<p>There are situations where you might need to create new tabs and buttons on the ribbon and all you have to work with is javascript. If you ever find yourself in such a situation here is a small example of javascript code to create  new button and a new tab: ExecuteOrDelayUntilScriptLoaded(function () { //Wait for&hellip; <a class=\"more-link\" href=\"/javascript-api-creating-ribbon-tabs-buttons/\">Continue reading <span class=\"screen-reader-text\">Javascript API for creating Ribbon Tabs and Buttons</span></a></p>\n","date":"April 13, 2017","modified":"April 13, 2017","author":{"node":{"id":"dXNlcjox","name":"admin","url":null,"description":null,"slug":"admin"}},"featuredImage":{"node":{"localFile":{"childImageSharp":{"fluid":{"tracedSVG":"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='360'%20height='240'%20viewBox='0%200%20360%20240'%20preserveAspectRatio='none'%3e%3cpath%20d='M115%205v16l1-7V6h86v8l1%208V3h-88v2M12%2013c0%202%200%202-6%202H0v72h41V15h-3c-2-1-3-1-2-2%202-2%201-3-4-3-3%200-5%201-5%202l-1-1-7-1c-7%200-7%200-7%203M2%2045c0%2015%200%2027%201%2026%200-3%202-3%202%200h1c0-2%203-2%204%200h1c0-1%202-1%203%201l3%201-1-2v-1c2-1%204%200%204%202s0%202-1%201l-1-1c0%203-9%203-9%200H8v1l-3%201c-2%200-3%200-3%205v6h37V17H2v28m124%20139a471%20471%200%20001%2028v-28h117l117-1H243l-117%201m4%203a291%20291%200%20000%2027l1-26h114l115-1H130'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e","aspectRatio":1.5,"src":"/static/21c5ee0186d0a1b5f9794a22758ff7c5/33b7e/ribbon_sonaelink.png","srcSet":"/static/21c5ee0186d0a1b5f9794a22758ff7c5/80ca6/ribbon_sonaelink.png 90w,\n/static/21c5ee0186d0a1b5f9794a22758ff7c5/65635/ribbon_sonaelink.png 180w,\n/static/21c5ee0186d0a1b5f9794a22758ff7c5/33b7e/ribbon_sonaelink.png 360w,\n/static/21c5ee0186d0a1b5f9794a22758ff7c5/47563/ribbon_sonaelink.png 540w,\n/static/21c5ee0186d0a1b5f9794a22758ff7c5/f383e/ribbon_sonaelink.png 690w","sizes":"(max-width: 360px) 100vw, 360px"}}}}},"categories":{"nodes":[{"id":"dGVybTo4","link":"/category/js/","count":4,"description":null,"name":"JavaScript","slug":"js"},{"id":"dGVybToxNQ==","link":"/category/sp/","count":29,"description":null,"name":"SharePoint","slug":"sp"}]},"tags":{"nodes":[{"id":"dGVybTo1MQ==","link":"/tag/custom-action/","count":1,"description":null,"name":"custom action","slug":"custom-action"},{"id":"dGVybTo3NA==","link":"/tag/javascript/","count":2,"description":null,"name":"javascript","slug":"javascript"},{"id":"dGVybTo3NQ==","link":"/tag/jquery/","count":1,"description":null,"name":"jQuery","slug":"jquery"},{"id":"dGVybToxMjk=","link":"/tag/ribbon/","count":1,"description":null,"name":"ribbon","slug":"ribbon"},{"id":"dGVybToxMzQ=","link":"/tag/sp/","count":26,"description":null,"name":"sharepoint","slug":"sp"},{"id":"dGVybToxNDc=","link":"/tag/sp-ribbon-js/","count":1,"description":null,"name":"sp.ribbon.js","slug":"sp-ribbon-js"}]}},"next":{"id":"cG9zdDoyNzI=","slug":"sharepoint-content-enrichment-webservice","status":"publish","title":"SharePoint Search – Content Enrichment WebService","excerpt":"<p>Recently we came across the need to manipulate the values of Managed Properties. In our specific case it was required that for some contents, the File Type Managed Property should be empty. In order to do so we used the Content Enrichment web service, which is a service that adds a custom step to content&hellip; <a class=\"more-link\" href=\"/sharepoint-content-enrichment-webservice/\">Continue reading <span class=\"screen-reader-text\">SharePoint Search &#8211; Content Enrichment WebService</span></a></p>\n","date":"April 06, 2017","modified":"April 06, 2017","author":{"node":{"id":"dXNlcjox","name":"admin","url":null,"description":null,"slug":"admin"}},"featuredImage":{"node":{"localFile":{"childImageSharp":{"fluid":{"tracedSVG":"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='360'%20height='240'%20viewBox='0%200%20360%20240'%20preserveAspectRatio='none'%3e%3cpath%20d='M0%20120v120h126l-4-3a95%2095%200%2001-24-28l-2-2-2-7-4-8-1-4-4-26c0-18%208-43%2018-55l3-4H95a472%20472%200%2000-35-2c-1-2-2-43%200-45l56-2c43%200%2055-1%2056-2%202-4%2018-9%2028-9s26%205%2027%209c1%202%2028%203%2061%203h30v46h-8l-19%201a547%20547%200%2000-35%203l2%203%202%203a94%2094%200%200114%2036c1%206%201%2031-1%2036l-2%208a128%20128%200%2001-13%2026l-21%2021-2%202h126V0H0v120m63-62l-1%2021%201%2020%2017-1c20%200%2033-1%2033-2l3-4c4-4%204-4%203-9-2-6%202-10%207-8%202%202%203%204%201%204l-2-1-2-1v2c-2-1-2%200-2%201%200%202%201%203%202%203l2-1%201-1%202-1c1-1%201%200%201%201v4c1%201%201-1%201-6%200-6%200-8%202-8l1%202%201%202c1-1%204%200%206%203l1%203v-6l6-3%202-1%201-2h1l1-1v-1l2-2%202-1%202-2%204-2c8-1-18-2-55-3l-44%201m185%200l-10%201h-4l2%203%206%207%201%202%203%207%203%208%201%202v1l1%202%201%203v2c-2%201%208%202%2037%202l27%201V58l-32-1-36%201m37%2012c-6%206-2%2015%208%2015%204%200%204%200%208%204l4%203c2%200%201-1-2-6-3-3-4-5-3-5l1-7-3-5c-4-4-8-4-13%201m2%201c-3%203-3%207%201%2010%205%204%2012%200%2011-6-2-6-8-8-12-4m-98%2064v22c-5%208-5%209-4%2011l1%201v5c0%204-2%204-5%200-3-7-4-7-3-1%200%205-1%208-5%209l-1%205v4c1-1%202%200%203%201l6%203c3%201%203%201%207-2l3-2%202-1%207-8c3-2%205-5%205-6h3v6c1%200%202-1%202-4%200-4%200-4%206-5%205-1%208-3%208-6%200-2%200-2-1-1l-2%203-8%202c-3%200-4-1-4-3l-2-3v-4l-1-1-3-6-2-6c1-2-2-2-4%200l-3%201-3-10c0-6-2-8-2-4m39%2027l-1%206c-1%204-1%204%201%203%202-2%201%2022-1%2027l-4%208-1%204c-3%204-7%2015-7%2017l-1%204-2%204-2%203c-2%202-2%202%202%202h4l4-9%2012-32-2-38c-2-1-2-1-2%201'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e","aspectRatio":1.5,"src":"/static/7aabdc72b4da0eb4f061643f66e44355/33b7e/search-1.png","srcSet":"/static/7aabdc72b4da0eb4f061643f66e44355/80ca6/search-1.png 90w,\n/static/7aabdc72b4da0eb4f061643f66e44355/65635/search-1.png 180w,\n/static/7aabdc72b4da0eb4f061643f66e44355/33b7e/search-1.png 360w,\n/static/7aabdc72b4da0eb4f061643f66e44355/47563/search-1.png 540w,\n/static/7aabdc72b4da0eb4f061643f66e44355/635ab/search-1.png 700w","sizes":"(max-width: 360px) 100vw, 360px"}}}}},"categories":{"nodes":[{"id":"dGVybToxNQ==","link":"/category/sp/","count":29,"description":null,"name":"SharePoint","slug":"sp"}]},"tags":{"nodes":[{"id":"dGVybTo1MA==","link":"/tag/crawl/","count":1,"description":null,"name":"crawl","slug":"crawl"},{"id":"dGVybTo4MA==","link":"/tag/managed/","count":1,"description":null,"name":"managed","slug":"managed"},{"id":"dGVybToxMDY=","link":"/tag/onpremise/","count":1,"description":null,"name":"onpremise","slug":"onpremise"},{"id":"dGVybToxMjE=","link":"/tag/properties/","count":1,"description":null,"name":"properties","slug":"properties"},{"id":"dGVybToxMzI=","link":"/tag/search/","count":3,"description":null,"name":"search","slug":"search"},{"id":"dGVybToxMzQ=","link":"/tag/sp/","count":26,"description":null,"name":"sharepoint","slug":"sp"},{"id":"dGVybToxNzE=","link":"/tag/wcf/","count":1,"description":null,"name":"wcf","slug":"wcf"}]}}}},"staticQueryHashes":["118757218","1271460761","1853074139","63159454"]}